
---
title: "Effects of Different Pain Relievers and Dosages on Cognitive Retention"
author: 
  - Navya Hooda
  - Mohammed Yusuf Shaikh
  - Shivank Goel
  - Vanshika Vanshika
  - Jena Shah
date: today
date-format: long
number-sections: true
format: pdf
---


```{r}
#| include: false
#| warning: false
#| message: false

library(tidyverse)
library(janitor)
library(here)
library(lubridate)
library(arrow)
library(dplyr)
library(knitr)
library(performance)
library(kableExtra)

clean_data <- read.csv(here("data", "analysis_data", "clean_data.csv"))


```



```{r}
#| echo: false
#| warning: false
#| message: false

clean_data$improvement <- clean_data$game_after - clean_data$game_before

improvement_summary <- clean_data %>%
  group_by(drug) %>%
  summarise(
    Mean_Improvement = mean(improvement, na.rm = TRUE),
    SD_Improvement = sd(improvement, na.rm = TRUE),
    Median_Improvement = median(improvement, na.rm = TRUE)
  )

kable(improvement_summary, format = "latex", booktabs = TRUE, caption = "Mean Improvement in Game Scores by Drug")

```

```{r}
#| echo: false
#| warning: false
#| message: false

# References:
# https://tellingstorieswithdata.com/
# https://q.utoronto.ca/courses/376099/pages/project-descriptions?module_item_id=6379323


m1_game_before <- mean(clean_data$game_before, na.rm = TRUE)
m2_game_before <- median(clean_data$game_before, na.rm = TRUE)
m3_game_before <- sd(clean_data$game_before, na.rm = TRUE)
m4_game_before <- IQR(clean_data$game_before, na.rm = TRUE)

m1_game_after <- mean(clean_data$game_after, na.rm = TRUE)
m2_game_after <- median(clean_data$game_after, na.rm = TRUE)
m3_game_after <- sd(clean_data$game_after, na.rm = TRUE)
m4_game_after <- IQR(clean_data$game_after, na.rm = TRUE)

m1_cards_before <- mean(clean_data$cards_before, na.rm = TRUE)
m2_cards_before <- median(clean_data$cards_before, na.rm = TRUE)
m3_cards_before <- sd(clean_data$cards_before, na.rm = TRUE)
m4_cards_before <- IQR(clean_data$cards_before, na.rm = TRUE)

m1_cards_after <- mean(clean_data$cards_after, na.rm = TRUE)
m2_cards_after <- median(clean_data$cards_after, na.rm = TRUE)
m3_cards_after <- sd(clean_data$cards_after, na.rm = TRUE)
m4_cards_after <- IQR(clean_data$cards_after, na.rm = TRUE)

# Combine into a table
summary_table <- data.frame(
  Statistic = c("Mean", "Median", "SD", "IQR"),
  Game_Before = c(m1_game_before, m2_game_before, m3_game_before, m4_game_before),
  Game_After = c(m1_game_after, m2_game_after, m3_game_after, m4_game_after),
  Cards_Before = c(m1_cards_before, m2_cards_before, m3_cards_before, m4_cards_before),
  Cards_After = c(m1_cards_after, m2_cards_after, m3_cards_after, m4_cards_after)
)

kable(summary_table, format = "latex", booktabs = TRUE, caption = "Summary Statistics for Quantitative Variables") 
```

# Introduction

```{r}
#| echo: false
#| warning: false
#| message: false

# Count and percentage for Drug
drug_counts <- table(clean_data$drug)
drug_percentages <- prop.table(drug_counts) * 100
drug_summary <- data.frame(Drug = names(drug_counts), Count = as.numeric(drug_counts), Percentage = round(as.numeric(drug_percentages), 2))
colnames(drug_summary) <- c("Drug", "Count", "Percentage")


# Count and percentage for Dosage Level
dosage_counts <- table(clean_data$dosage_level)
dosage_percentages <- prop.table(dosage_counts) * 100
dosage_summary <- data.frame(Dosage = names(dosage_counts), Count = as.numeric(dosage_counts), Percentage = round(as.numeric(dosage_percentages), 2))

# Count and percentage for Location
location_counts <- table(clean_data$location)
location_percentages <- prop.table(location_counts) * 100
location_summary <- data.frame(Location = names(location_counts), Count = as.numeric(location_counts), Percentage = round(as.numeric(location_percentages), 2))

# Count and percentage for Age Group
age_counts <- table(clean_data$age_group)
age_percentages <- prop.table(age_counts) * 100
age_summary <- data.frame(Age_Group = names(age_counts), Count = as.numeric(age_counts), Percentage = round(as.numeric(age_percentages), 2))

# Print tables
kable(drug_summary, format = "latex", booktabs = TRUE, caption = "Summary of Drug Types") 

kable(dosage_summary, format = "latex", booktabs = TRUE, caption = "Summary of Dosage Levels") 

kable(location_summary, format = "latex", booktabs = TRUE, caption = "Summary of Locations") 

kable(age_summary, format = "latex", booktabs = TRUE, caption = "Summary of Age Groups") 
```

\newpage


```{r}
#| echo: false
#| warning: false
#| message: false
#| fig.width: 9
#| fig.height: 8
#| dpi: 300
#| fig-cap: "Boxplot of Game Scores Before and After by Drug"

library(ggplot2)
library(patchwork)  

#References
#https://r-graph-gallery.com/package/patchwork.html

clean_data$drug <- factor(clean_data$drug, labels = c("Aspirin", "Paracetamol", "Placebo", "Tramadol"))

# Create first boxplot
p1 <- ggplot(clean_data, aes(x = drug, y = game_before, fill = drug)) + 
  geom_boxplot() +
  labs(title = "Memory Game Scores Before Treatment", x = "Drug Type", y = "Game Score", fill = "Drug") +
  theme_minimal()

# Create second boxplot
p2 <- ggplot(clean_data, aes(x = drug, y = game_after, fill = drug)) + 
  geom_boxplot() +
  labs(title = "Memory Game Scores After Treatment", x = "Drug Type", y = "Game Score", fill = "Drug") +
  theme_minimal()

p1 / p2 + plot_annotation()

```



```{r}
#| echo: false
#| warning: false
#| message: false
#| fig.width: 9
#| fig.height: 8
#| dpi: 300
#| fig-cap: "Boxplot of Memory Card Scores Before and After by Drug"

library(ggplot2)
library(patchwork)

clean_data$drug <- factor(clean_data$drug, labels = c("Aspirin", "Paracetamol", "Placebo", "Tramadol"))

p1 <- ggplot(clean_data, aes(x = drug, y = cards_before, fill = drug)) + 
  geom_boxplot() +
  labs(title = "Memory Card Scores Before Treatment", x = "Drug Type", y = "Memory Card Score", fill = "Drug") +
  theme_minimal()

p2 <- ggplot(clean_data, aes(x = drug, y = cards_after, fill = drug)) + 
  geom_boxplot() +
  labs(title = "Memory Card Scores After Treatment", x = "Drug Type", y = "Memory Card Score", fill = "Drug") +
  theme_minimal()

p1 / p2 + plot_annotation()

```

```{r}
#| echo: false
#| warning: false
#| message: false
#| fig.width: 7
#| fig.height: 4
#| dpi: 300
#| fig-cap: "Distribution of Dosage Levels"

ggplot(clean_data, aes(x = dosage_level, fill = dosage_level)) +
  geom_bar() +
  labs(title = "Distribution of Dosage Levels", x = "Dosage Level", y = "Count") +
  theme_minimal()

```




# References
